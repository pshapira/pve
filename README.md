# Code and Data Repository for 'Large-Scale Text Analysis Using Generative Language Models: A Case Study in Discovering Public Value Expressions in AI Patents' [[preprint on arXiv]](https://arxiv.org/abs/2305.10383)
## by Sergio Pelaez*, Gaurav Verma*, Barbara Ribeiro, Philip Shapira<sup>1</sup>
### * = Co-First author, <sup>1</sup> Corresponding author: pshapira@manchester.ac.uk

We provide the code used to make API calls to GPT-4 for obtaining labels and rationales for 10,000 sentences sampled from the patent documents. The code contains the instructions as well as the examples supplied to GPT-4 as part of the prompt.

# Code using GPT-4 for labeling and obtaining rationales for 10,000 sentences
Check the file `gpt-4_script.py` that loads the `10k_sentences_to_annotate.csv` file and calls GPT-4 to obtain their labels and rationales. The file contains the instruction provided to GPT-4 (line 27-31) and the final 14 examples along with their rationales (lines 33-73). The API calls to GPT-4 are made sentence by sentence, and the generated labels and rationales are parsed and stored in a python pickle file for later use and analysis. We use `python3` for all our scripts.

# Data: 10k sentences, their generated labels, and rationales

**10k sentences**: The ~10,000 sentences that were labeled using GPT-4 are availabe in `10k_sentences_to_annotated.csv` under the `./data` subdirectory. The sampling strategy for obtaining these 10k sentences is discusses in the preprint. 

**Labels and rationales**: We have stored the labels and rationales generated by GPT-4 for these sentences in a python3 pickle file `10k_responses_gpt4.pkl` under the `./data` subdirectory. For ease of viewing and interacting with the data, we have also reformmated the pickle file into an Excel spreadsheet, which is available as `10k_responses_gpt4.xlsx` under the `./data` subdirectory.
